# -*- coding: utf-8 -*-
"""Mielage_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1f7ekmiAVPSwfU9LJ2keUaiBPDeMct6Li

***Mileage Prediction-Regression Analysis***

**Source**

This dataset was taken from the StatLib library which is maintained at Camegie Mellon University. The dataset was used in the 1983 American Statistical Association Exposition.

**Data Set Information**

This dataset is a slightly modified version of the dataset provided in the StatLib library. In line with the use by Ross Quinlan in predicting the attribute 'mpg',8 of the original instances were removed because they had unknown values for the 'mpg' attribute. The original dataet is available in the file "auto-mpg.data-original".
"""

#Import library
import pandas as pd

import numpy as np

import seaborn as sns

#import data
mpg=pd.read_csv("https://github.com/YBI-Foundation/Dataset/raw/main/MPG.csv")
mpg.dropna()

#Describe data
mpg.describe()

#Data preprocessing
mpg.head()

mpg.info()

#Data visualization
sns.pairplot(mpg,x_vars=['displacement','horsepower','weight','acceleration','mpg'],y_vars=['mpg']);

sns.regplot(x='displacement',y='mpg', data=mpg);

#Define target variable (y) and feature variable(x)
mpg.columns

y=mpg['mpg']

x=mpg[['displacement', 'horsepower', 'weight',
       'acceleration']]
x.fillna(0,inplace=True)
y.fillna(0,inplace=True)

#Split
from sklearn.model_selection import train_test_split

x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=2529)

x_train.shape,x_test.shape,y_train.shape,y_test.shape

#Modeling
from sklearn.linear_model import LinearRegression

model=LinearRegression()

model.fit(x_train,y_train)

y_pred=model.predict(x_test)

model.intercept_

model.coef_

#Prediction
y_pred=model.predict(x_test)

y_pred

#Accuracy
from sklearn.metrics import mean_absolute_error,mean_absolute_percentage_error

mean_absolute_error(y_test,y_pred)

mean_absolute_percentage_error(y_test,y_pred)